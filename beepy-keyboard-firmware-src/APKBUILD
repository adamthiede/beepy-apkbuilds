# Contributor:
# Maintainer:
pkgname=beepy-keyboard-firmware-src
_modname=beepy-kbd
_modver=2.11
pkgver=1
pkgrel=0
pkgdesc="beepy bbq20 keyboard firmware"
url="https://github.com/adamthiede/beepberry-keyboard-driver"
arch="all"
license=""
depends=""
makedepends="linux-rpi-dev"
checkdepends=""
install=""
subpackages=""
source="$pkgname-$pkgver.tar.gz::https://github.com/adamthiede/beepberry-keyboard-driver/archive/refs/tags/$pkgver.tar.gz"
builddir="$srcdir/beepberry-keyboard-driver-$pkgver"
options="!check" #no tests

prepare() {
	default_prepare

	cat >AKMBUILD <<-EOF
	modname=$_modname
	modver=$_modver
	built_modules=$_modname.ko

	build() {
		make \$MAKEFLAGS KVER="\$kernel_ver" KSRC="\$kernel_srcdir" modules
	}
	EOF

}

build() {
	make
}

package() {
	# Replace with proper package command(s)
	local destdir="$pkgdir/usr/src/$_modname-$pkgver"
	install -Dm644 -t "$destdir" AKMBUILD Makefile
	cp -r core hal include os_dep platform "$destdir"

}

sha512sums="
5f266114070ae98baabca1199b3beb2f47a0eea61257650cbf4e2c23b20ff603b32fd0da9f374e0c8c05ea1122813e3dca2f966b96679b7aa18ddf1918a9a03b  beepy-keyboard-firmware-src-1.tar.gz
"
